<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Print to PDF</title>
    <!-- Add html2pdf library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- Add required fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <style>
        .print-content {
            /* width: 210mm;  /* A4 width */
            /* margin: 0 auto; */ 
            background-color: #f6f6f6;
            font-family: 'Montserrat', Arial, sans-serif;
        }
        
        .main-table {
            width: 100%;
            max-width: 210mm;  /* A4 width */
            margin: 0 auto;
            background-color: #ffffff;
        }

        .no-print {
            display: block;
        }

        @media print {
            .print-content {
                width: 210mm;
                margin: 0;
                padding: 0;
            }
            
            .no-print {
                display: none;
            }

            body {
                margin: 0;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="print-content" id="print-content">
        <table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="background-color: #f6f6f6; padding: 20px;">
            <tr>
                <td>
                    <table role="presentation" cellpadding="0" cellspacing="0" width="500" style="margin: 0 auto; background-color: #ffffff; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <!-- Header -->
                        <tr>
                            <td style="padding: 15px;">
                                <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td width="50%" style="vertical-align: top;">
                                            <table role="presentation" cellpadding="0" cellspacing="0">
                                                <tr>
                                                    <td style="padding-right: 8px;">
                                                        <img src="https://i.imgur.com/Aey3PSi.png" alt="Maketronics Logo" style="width: 60px; height: 60px;">
                                                    </td>
                                                    <td style="vertical-align: top;">
                                                        <p style="margin: 0; color: #003399; font-weight: 600; font-size: 10px; font-family: 'Montserrat', sans-serif; line-height: 1.4;">Specialists in sourcing</p>
                                                        <p style="margin: 5px 0; color: #003399; font-weight: 600; font-size: 10px; font-family: 'Montserrat', sans-serif; line-height: 1.4;">EOL, hard-to-find &</p>
                                                        <p style="margin: 0; color: #003399; font-weight: 600; font-size: 10px; font-family: 'Montserrat', sans-serif; line-height: 1.4;">long lead-time components</p>
                                                    </td>
                                                    <td width="50%" style="text-align: left; color: #004aad; font-weight: 600; padding-left: 90px; vertical-align: top;">
                                                        <p style="margin: 0; font-size: 10px; line-height: 1.0;" data-field="quotationNo">Quotation Number: [Number]</p>
                                                        <p style="margin: 5px 0; font-size: 10px; line-height: 1.0;" data-field="date">Date: [Date]</p>
                                                        <p style="margin: 0; font-size: 10px; line-height: 1.0;" data-field="validFor" >Valid for: 5 days</p>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
    
                        <!-- Title -->
                        <tr>
                            <td style="text-align: center; padding: 10px;">
                                <h1 style="color: #003399; margin: 0; font-size: 16px; text-decoration: underline; font-family: 'Montserrat', sans-serif; font-weight: 700;"><i>Quotation</i></h1>
                            </td>
                        </tr>
    
                        <!-- Prepared For/By Section -->
                        <tr>
                            <td style="padding: 0 10px;">
                                <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td width="50%" style="padding: 10px;">
                                            <p style="margin: 0; font-weight: 600; font-size: 12px; color: #003399;" >Prepared for:</p>
                                            <p style="margin: 8px 0; font-size: 12px; color: #004aad; line-height: 0.6;" data-field="clientName">Name</p>
                                            <p style="margin: 0; font-size: 12px; color: #004aad; line-height: 0.6;" data-field="clientCompany">Company's Name</p>
                                        </td>
                                        <td width="50%" style="padding: 10px;">
                                            <p style="margin: 0; font-weight: 600; font-size: 12px; color: #003399;">Prepared By:</p>
                                            <p style="margin: 8px 0; font-size: 12px; color: #004aad; line-height: 0.6;" data-field="preparedByName">Name</p>
                                            <p style="margin: 0; font-size: 12px; color: #004aad; line-height: 1.1;">Maketronics Communications LLC-FZ</p>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
    
                        <!-- Quotation Table -->
                        <tr>
                            <td style="padding: 15px;">
                                <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse;">
                                    <tr style="background-color: #f8f9fa;">
                                        <th style="padding: 12px; border: 1px solid #003399; color: #003399; font-size: 13px; font-weight: 600; text-align: center;">Part #</th>
                                        <th style="padding: 12px; border: 1px solid #003399; color: #003399; font-size: 13px; font-weight: 600; text-align: center;">Qty</th>
                                        <th style="padding: 12px; border: 1px solid #003399; color: #003399; font-size: 13px; font-weight: 600; text-align: center;">DC</th>
                                        <th style="padding: 12px; border: 1px solid #003399; color: #003399; font-size: 13px; font-weight: 600; text-align: center;">Price per unit</th>
                                    </tr>
                                    <!-- Parts rows will be inserted here -->
                                </table>
                                
                                <!-- Additional Information -->
                                <div style="margin-top: 20px;">
                                    <ul style="list-style-type: disc; padding-left: 20px; margin: 0;">
                                        <li style="color: #4A4A4A; font-size: 12px;">
                                            <strong>Lead Time:</strong> <span id="leadTimeText"></span>
                                        </li>
                                        <li style="color: #4A4A4A; font-size: 12px;">
                                            <strong>Conditions:</strong> <span id="conditionsText"></span>
                                        </li>
                                        <li style="color: #4A4A4A; font-size: 12px;">
                                            <strong>Other Charges:</strong> <span id="otherChargesText"></span>
                                        </li>
                                    </ul>
                                </div>
                            </td>
                        </tr>
    
                        <!-- Separator Line -->
                        <tr>
                            <td style="padding: 0 10px;">
                                <hr style="border: 0; border-top: 2px solid #004aad;">
                            </td>
                        </tr>
    
                        <!-- Features -->
                        <tr>
                            <td style="padding: 10px;">
                                <table role="presentation" width="100%" cellpadding="0" cellspacing="0"> 
                                    <tr>
                                        <td width="40%" style="padding: 10px;">
                                            <p style="font-size: 13px; margin: 0; font-family: 'Montserrat', sans-serif; font-weight: 600; color: #003399;">Proudly Serving 7 industries in 14 countries</p>
                                        </td>
                                        
                                        <td width="20%" style="text-align: center; padding: 10px;">
                                            <img src="https://i.imgur.com/IJiTmbX.png" alt="ISO Certificate" style="width: 80px; height: 80px;">
                                        </td>
                                        <td width="20%" style="text-align: center; padding: 10px;">
                                            <img src="https://i.imgur.com/ZSiF98Z.png" alt="IDEA Certificate" style="width: 80px; height: 80px;">
                                        </td>
                                        <td width="20%" style="text-align: center; padding: 10px;">
                                            <img src="https://i.imgur.com/7DJkL4o.png" alt="Testing Certificate" style="width: 67px;height: 72px;max-width: 100vw;max-height: 100vw;">
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
    
                        <!-- Separator Line -->
                        <tr>
                            <td style="padding: 0 10px;">
                                <hr style="border: 0; border-top: 2px solid #004aad;">
                            </td>
                        </tr>
    
                        <!-- Certifications -->
                        <tr>
                            <td style="padding: 10px;">
                                <table role="presentation" width="100%" cellpadding="0" cellspacing="0"> 
                                    <tr>
                                        <td width="40%" style="padding: 10px;">
                                            <p style="font-size: 13px; margin: 0; font-family: 'Montserrat', sans-serif; font-weight: 600; color: #003399;">Quality is <span style="color: #FF0000;">EVERYTHING</span> for us</p>
                                        </td>
                                        
                                        <td width="20%" style="text-align: center; padding: 10px;">
                                            <img src="https://i.imgur.com/5Hi7kkA.png" alt="ISO Certificate" style="width: 69px;height: 75px;max-width: 100vw;max-height: 100vw;">
                                        </td>
                                        <td width="20%" style="text-align: center; padding: 10px;">
                                            <img src="https://i.imgur.com/4nK5Vgy.png" alt="IDEA Certificate" style="width: 80px; height: 80px;">
                                        </td>
                                        <td width="20%" style="text-align: center; padding: 10px;">
                                            <img src="https://i.imgur.com/0CQrZr2.png" alt="Testing Certificate" style="width: 80px; height: 80px;">
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <!-- Separator Line -->
                        <tr>
                            <td style="padding: 0 10px;">
                                <hr style="border: 0; border-top: 2px solid #004aad;">
                            </td>
                        </tr>
                        <!-- Two Column Section -->
                        <tr>
                            <td style="padding: 10px;">
                                <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td width="50%" style="text-align: center;padding: 5px;">
                                            <p style="margin: 0;border: 1px solid #004aad;padding: 1px;font-size: -2px;color: #4A4A4A;"><a href="https://www.trustpilot.com/review/make-tronics.com?utm_medium=trustbox&amp;utm_source=TrustBoxReviewCollector" target="_blank"><img src="https://i.imgur.com/8JAgqYP.png" alt="TrustPilot Reviews" style="width: 190px; height: 52px;"></a></p>
                                        </td>
                                        <td width="50%" style="text-align: center;padding: 0px;">
                                            <p style="margin: 0;border: 1px solid #004aad;padding: 9px;font-size: 11px;color: #4A4A4A;"><a href="https://www.linkedin.com/company/maketronics/posts/?feedView=all" target="_blank"><img src="https://i.imgur.com/5lErpaU.png" alt="Linkedin Customer Success Stories" style="width: 180px;height: 38px;"></a></p>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
    
                        <!-- Footer -->
                        <tr>
                            <td style="padding: 10px; text-align: center; background-color: #f8f9fa;">
                                <div style="margin-top: 10px;"></div>
                                        <a href="https://www.linkedin.com/company/maketronics/" style="margin: 0 10px; text-decoration: none;"><img src="https://i.imgur.com/tTXdZHM.png" alt="LinkedIn" style="width: 20px; height: 20px;"></a>
                                    <a href="https://make-tronics.com" style="margin: 0 10px; text-decoration: none;"><img src="https://i.imgur.com/oOuSOld.png" alt="Website" style="width: 20px; height: 20px;"></a>
                                    <a href="mailto:sales@make-tronics.com" style="margin: 0 10px; text-decoration: none;"><img src="https://i.imgur.com/sSPY07q.png" alt="Website" style="width: 20px; height: 20px;"></a>
                                </div>
                                <p style="margin: 0; font-weight: 600; color: #003399; font-size: 10px;">Maketronics Communications LLC-FZ</p>
                                <p style="margin: 5px 0; font-size: 10px; color: #4A4A4A; line-height: 1.1;">Meydan Grandstand, 6th floor, Meydan road, Nad Al Sheba, Dubai, U.A.E</p>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
    <button onclick="downloadPDF()" class="no-print">Print PDF</button>
    
    <script>
        window.onload = function() {
            const quotationData = JSON.parse(localStorage.getItem('quotationData'));
            console.log(quotationData);
            if (quotationData) {
                // Fill quotation details
                document.querySelector('[data-field="quotationNo"]').textContent = quotationData.quotationNo;
                document.querySelector('[data-field="date"]').textContent = quotationData.date;
                document.querySelector('[data-field="validFor"]').textContent = quotationData.validFor;
                
                // Fill client details
                document.querySelector('[data-field="clientName"]').textContent = quotationData.clientName;
                document.querySelector('[data-field="clientCompany"]').textContent = quotationData.clientCompany;
                
                // Fill prepared by details
                document.querySelector('[data-field="preparedByName"]').textContent = quotationData.preparedByName;
                
                // Generate parts table rows
                const tableBody = document.getElementById('partsTable');
                if (quotationData.parts && quotationData.parts.length > 0) {
                    tableBody.innerHTML = quotationData.parts.map(part => `
                        <tr>
                            <td style="padding: 12px; border: 1px solid #003399; font-size: 13px; color: #4A4A4A; text-align: center;">${part.partNo}</td>
                            <td style="padding: 12px; border: 1px solid #003399; font-size: 13px; color: #4A4A4A; text-align: center;">${part.qty}</td>
                            <td style="padding: 12px; border: 1px solid #003399; font-size: 13px; color: #4A4A4A; text-align: center;">${part.dc}</td>
                            <td style="padding: 12px; border: 1px solid #003399; font-size: 13px; color: #4A4A4A; text-align: center;">${part.currency} ${part.pricePerUnit}</td>
                        </tr>
                    `).join('');
                }
            }
        };

        function downloadPDF() {
            window.print();
        }
    </script>
</body>
</html>